name: Qualys WAS Scan 
on:
  push:
    branches:
      - master
jobs:
    Qualys_was_scan:
        runs-on: ubuntu-latest
        name: Qualys WAS Scan
        steps:
          - name: Checkout
            uses: actions/checkout@v3 
            with:
                fetch-depth: 0
    
          - name: Qualys WAS scan action step
            uses: Qualys/github-action-qwas@main
            id: was
            with:
              API_SERVER: ${{ vars.API_SERVER }}
              QUALYS_USERNAME: ${{ vars.QUALYS_USERNAME }}
              QUALYS_PASSWORD: ${{ secrets.QUALYS_PASSWORD }}
              WEBAPP_ID: ${{ vars.WEBAPP_ID }}
              SCAN_NAME: ${{ vars.SCAN_NAME }}
              SCAN_TYPE: ${{ vars.SCAN_TYPE }}
              AUTH_RECORD: none
              AUTH_RECORD_ID: ""
              OPTION_PROFILE: useDefault
              OPTION_PROFILE_ID: ""
              CANCEL_OPTION: false
              CANCEL_HOURS: ""
              SEVERITY_CHECK: false
              SEVERITY_LEVEL: 1
              EXCLUDE: ""
              FAIL_ON_SCAN_ERROR: false
              WAIT_FOR_RESULT: true
              INTERVAL: 	5
              TIMEOUT: 350
